<div style="min-height: 100vh; background-color: #f8fafc;">

  <!-- Logo Section -->
  <div style="background-color: white; padding: 32px 0; border-bottom: 1px solid #e2e8f0;">
    <div style="display: flex; justify-content: center;">
      <img 
        src="https://jritzygwfhfqrlogqcpy.supabase.co/storage/v1/object/public/logos/EXPRESSPAY.png" 
        alt="ExpressPay" 
        style="height: 80px; object-fit: contain;"
      />
    </div>
  </div>


  <!-- Client Info Section -->
  <div style="background-color: #f6f6f6; padding: 20px 0;">
    <div style="max-width: 800px; margin: 0 auto; padding: 0 24px;">
      <div style="display: flex; align-items: center; gap: 16px;">
        <div style="width: 48px; height: 48px; border-radius: 50%; background-color: #00afc0; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
          <i class="pi pi-building" style="color: white; font-size: 18px;"></i>
        </div>
        <div style="flex: 1; min-width: 0;">
          <p style="font-size: 14px; margin-bottom: 8px; color: #777777;">Cliente</p>
          <h1 style="font-size: 20px; line-height: 1.2; word-wrap: break-word; font-weight: 600; color: #333333; margin: 0;">{{ cliente }}</h1>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div style="background-color: #fbfbfb; padding: 32px 0 48px 0;">
    <div style="max-width: 800px; margin: 0 auto; padding: 0 24px;">
      
      <!-- Financial Details Card -->
      <div style="background-color: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); border: 1px solid #e2e8f0; margin-bottom: 32px;">
        <div style="padding: 24px;">
          <div style="text-align: center; margin-bottom: 24px;">
            <h3 style="font-weight: 600; color: #333333; margin: 0;">Detalle de Cesión de Factoraje</h3>
          </div>
          
          <div style="display: flex; flex-direction: column; gap: 16px;">
            <div *ngFor="let detail of invoiceDetails; let last = last" 
                 [ngStyle]="last ? {
                   'display': 'flex',
                   'justify-content': 'space-between',
                   'align-items': 'center',
                   'padding': '12px 16px',
                   'border-radius': '8px',
                   'margin-top': '16px',
                   'background-color': '#f0fbfc'
                 } : {
                   'display': 'flex',
                   'justify-content': 'space-between',
                   'align-items': 'center',
                   'padding': '8px 0',
                   'border-bottom': '1px solid #f0f0f0'
                 }">
              <span [ngStyle]="{'color': '#666666'}">{{ detail.concept }}</span>
              <span [ngStyle]="last ? {'font-weight': 'bold', 'color': '#333333'} : {'color': '#333333'}">{{ detail.valor }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Comment Button -->
      <div *ngIf="validarEstado()" style="text-align: center; margin-bottom: 24px;">
        <button *appHasAction="'Aprobar o denegar'" pButton icon="pi pi-plus" label="Agregar comentario"
          (click)="mostrarModalComentario()"
          [ngStyle]="{
            'background-color': '#64748b',
            'color': 'white',
            'border': 'none',
            'padding': '12px 24px',
            'border-radius': '8px',
            'font-weight': '500',
            'cursor': 'pointer',
            'transition': 'all 0.2s ease'
          }">
        </button>
      </div>

      <!-- Action Buttons -->
      <div *ngIf="validarEstado()" style="display: flex; justify-content: center; gap: 16px; margin-bottom: 32px;">
        <button *appHasAction="'Aprobar o denegar'" pButton label="Aceptar"
          (click)="confirmarSolicitud('aprobar')"
          [ngStyle]="{
            'background-color': '#00bfcb',
            'color': 'white',
            'border': 'none',
            'padding': '16px 32px',
            'border-radius': '8px',
            'font-weight': '600',
            'cursor': 'pointer',
            'transition': 'all 0.2s ease'
          }">
        </button>
        <button *appHasAction="'Aprobar o denegar'" pButton label="Denegar"
          (click)="denegarSolicitud('denegar')"
          [ngStyle]="{
            'background-color': '#ef4444',
            'color': 'white',
            'border': 'none',
            'padding': '16px 32px',
            'border-radius': '8px',
            'font-weight': '600',
            'cursor': 'pointer',
            'transition': 'all 0.2s ease'
          }">
        </button>
      </div>

      <!-- Approver Info -->
      <div *ngIf="validarEstado()" style="background-color: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); border: 1px solid #e2e8f0; padding: 24px; text-align: center;">
        <div style="display: flex; flex-direction: column; gap: 8px;">
          <p style="font-size: 14px; color: #666666; margin: 0;">
            <span style="font-weight: 600;">Nombre del Aprobador:</span> {{ aprobador }}
          </p>
          <p style="font-size: 14px; color: #666666; margin: 0;">
            <span style="font-weight: 600;">Fecha:</span> {{ fecha }}
          </p>
        </div>
      </div>
    </div>
  </div>

<!-- Modal para ingresar comentario -->
<p-dialog header="Agregar Comentario" [(visible)]="modalComentarioVisible" [style]="{width: '50%'}" [modal]="true"
  [closable]="true">
  <div class="modal-content">
    <textarea [(ngModel)]="comentario" pInputTextarea rows="5" cols="30"
      placeholder="Escribe tu comentario..."></textarea>
  </div>
  <p-footer>
    <button pButton label="Guardar" class="p-button-success" (click)="guardarComentario()"></button>
    <button pButton label="Cancelar" class="p-button-danger" (click)="cancelarComentario()"></button>
  </p-footer>
</p-dialog>

<!-- Confirmación de acción (Aceptar o Denegar solicitud) -->
<p-dialog [header]="accion == 'aprobar' ? 'Aprobación' : 'Denegación' " [(visible)]="modalAccionVisible"
  [style]="{width: '30vw'}">
  <p>¿Está seguro de que desea ejecutar esta acción?</p>
  <p-footer>
    <button pButton [loading]="loading" label="Sí" icon="pi pi-check" class="p-button-success"
      (click)="ejecutarAccion()"></button>
    <button pButton label="No" icon="pi pi-times" class="p-button-danger" (click)="cancelarAccion()"></button>
  </p-footer>
</p-dialog>

</div>